linear_model <- lm(y_highs ~ x, data=df)
linear_model <- lm(Extreme-high ~ Year, data=Extremes_DF)
#2. Evaluations
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
years = 1997:2018
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = Tair_extreme_POT %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-extreme"]))
}
linear_model <- lm(Extreme_high ~ Year, data=Extremes_DF)
View(linear_model)
summary(linear_model)
lm_highs <- lm(Extreme_high ~ Year, data=Extremes_DF)
summary(lm_highs)
plot(Extremes_DF$Year, Extremes_DF$`Extreme-highs`)
abline(lm(Extreme_high ~ Year, data=Extremes_DF))
lm_highs <- lm(Extreme_high ~ Year, data=Extremes_DF)
plot(Extremes_DF$Year, Extremes_DF$`Extreme-highs`)
abline(lm(Extreme_high ~ Year, data=Extremes_DF))
View(Extremes_DF)
#2. Evaluations
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
years = 1997:2018
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = Tair_extreme_POT %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-extreme"]))
}
lm_highs <- lm(Extreme_high ~ Year, data=Extremes_DF)
plot(Extremes_DF$Year, Extremes_DF$`Extreme-highs`)
plot(Extremes_DF$Year, Extremes_DF$`Extreme-highs`)
plot(Extremes_DF$Year, Extremes_DF$Extreme-highs)
plot(Extremes_DF$Year, Extremes_DF$Extreme_highs)
plot(Extremes_DF$Year, Extremes_DF$Extreme_high)
abline(lm(Extreme_high ~ Year, data=Extremes_DF))
plot(Extremes_DF$Year, Extremes_DF$`Extreme-lows`)
plot(Extremes_DF$Year, Extremes_DF$Extreme_high)
abline(lm(Extreme_high ~ Year, data=Extremes_DF))
points(Extremes_DF$Year, Extremes_DF$Extreme_low)
abline(lm(Extreme_low ~ Year, data=Extremes_DF))
plot(Extremes_DF$Year, Extremes_DF$Extreme_high, col="red")
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red")
points(Extremes_DF$Year, Extremes_DF$Extreme_low, col="blue")
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue")
lm_highs <- lm(Extreme_high ~ Year, data=Extremes_DF)
lm_lows <- lm(Extreme_low ~ Year, data=Extremes_DF)
Year = Extremes_DF$Year
High_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, High_Extremes, col="red")
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red")
points(Year, Low_Extremes, col="blue")
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue")
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, High_Extremes, col="red")
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red")
points(Year, Low_Extremes, col="blue")
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue")
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, High_Extremes, col="red")
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red")
points(Year, Low_Extremes, col="blue")
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue")
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red")
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red")
points(Year, Low_Extremes, col="blue")
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue")
legend(legend=c("Nr. of High Extremes", "Nr. of Low Extremes"), col=c("red","blue"))
legend("topleft", legend=c("Nr. of High Extremes", "Nr. of Low Extremes"), col=c("red","blue"))
legend("topleft", legend=c("Nr. of High Extremes", "Nr. of Low Extremes"), col=c("red","blue"), pch = c(1,1))
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16),
lty=c(1,1))
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16),
lty=c(2,2))
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2))
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red")
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue")
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,1,1))
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=1.5)
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=1.5)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=1.5)
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=3)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=3)
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2))
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
#2. Evaluations
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
years = 1997:2018
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
View(Extremes_per_year_POT)
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
#2. Evaluations
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
years = 1997:2018
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
print(table)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
#3. Quantiles function--------------
Quantiles = function(x, q_low, q_high){
x_mean = mean(x)
x_sd = sd(x)
y = dnorm(x, T1997_mean, T1997_sd)
qh = quantile(x,q_high*0.01)
ql = quantile(x,q_low*0.01)
above_qh = TairData$Tair_f[TairData$Tair_f > qh]
below_ql = TairData$Tair_f[TairData$Tair_f < ql]
print(paste("Percentage of values below q",q_low,": ",sep = ""))
print(length(above_q90) / length(TairData$Tair_f) * 100)
print(paste("Percentage of values above q",q_high,": ",sep = ""))
print(length(below_q10) / length(TairData$Tair_f) * 100)
plot(x,y)
lines(c(ql,ql), c(0,1), col="red", lwd=4)
lines(c(qh,qh), c(0,1), col="blue", lwd=4)
legend("topleft", legend=c(paste("Q",q_low,sep = ""), paste("Q",q_high,sep = "")), col=c("red","blue"), lty=1, lwd=4)
}
#2. Evaluations
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
years = 1997:2018
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
print(table)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
View(Extremes_per_year_POT)
#2. Evaluations
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
years = 1997:2018
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
TairData$Date[1]
TairData$Date[1].year
as.Date(TairData$Date[1])
as.Date(TairData$Date[1], format="%d/%m/%Y"),"%Y")
format(as.Date(TairData$Date[1], format="%d/%m/%Y"),"%Y")
as.integer(format(as.Date(TairData$Date[1], format="%d/%m/%Y"),"%Y"))
as.integer(format(as.Date(TairData$Date[-1], format="%d/%m/%Y"),"%Y"))
as.integer(format(as.Date(TairData$Date[nrow(TairData$Date)], format="%d/%m/%Y"),"%Y"))
as.integer(format(as.Date(TairData$Date[nrow(TairData$Date)-1], format="%d/%m/%Y"),"%Y"))
as.integer(format(as.Date(TairData$Date[500], format="%d/%m/%Y"),"%Y"))
nrow(TairData)
as.integer(format(as.Date(TairData$Date[nrow(TairData)], format="%d/%m/%Y"),"%Y"))
#2. Evaluations
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
startyear = as.integer(format(as.Date(df$Date[1], format="%d/%m/%Y"),"%Y"))
endyear = as.integer(format(as.Date(nrow(df), format="%d/%m/%Y"),"%Y"))
years = startyear:endyear
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
#2. Evaluations
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
startyear = as.integer(format(as.Date(df$Date[1], format="%d/%m/%Y"),"%Y"))
endyear = as.integer(format(as.Date(df$Date[nrow(df)], format="%d/%m/%Y"),"%Y"))
years = startyear:endyear
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
View(Extremes_per_year_POT)
## Extreme at 95th percentile using POT method---
Tair_extreme_POT = Extreme_detection(TairData$Tair_f, TairData$Date, 95, 'POT')
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
## Extreme at 95th percentile using POT method---
Tair_extreme_POT = Extreme_detection(TairData$Tair_f, TairData$Date, 50, 'POT')
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
## Extreme at 95th percentile using POT method---
Tair_extreme_POT = Extreme_detection(TairData$Tair_f, TairData$Date, 75, 'POT')
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
startyear = as.integer(format(as.Date(df$Date[1], format="%d/%m/%Y"),"%Y"))
endyear = as.integer(format(as.Date(df$Date[nrow(df)], format="%d/%m/%Y"),"%Y"))
years = startyear:endyear
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
Not_Extreme = Extremes_DF$Not_extreme
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
points(year, Not_Extreme, pch=1)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
startyear = as.integer(format(as.Date(df$Date[1], format="%d/%m/%Y"),"%Y"))
endyear = as.integer(format(as.Date(df$Date[nrow(df)], format="%d/%m/%Y"),"%Y"))
years = startyear:endyear
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
Not_Extreme = Extremes_DF$Not_extreme
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
points(Year, Not_Extreme, pch=1)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
## Extreme at 95th percentile using POT method---
Tair_extreme_POT = Extreme_detection(TairData$Tair_f, TairData$Date, 75, 'POT')
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
startyear = as.integer(format(as.Date(df$Date[1], format="%d/%m/%Y"),"%Y"))
endyear = as.integer(format(as.Date(df$Date[nrow(df)], format="%d/%m/%Y"),"%Y"))
years = startyear:endyear
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
Not_Extreme = Extremes_DF$Not_extreme
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
points(Year, Not_Extreme, pch=1)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
## Extreme at 95th percentile using POT method---
Tair_extreme_POT = Extreme_detection(TairData$Tair_f, TairData$Date, 75, 'POT')
Extremes_per_year_POT = Extremes_per_year(Tair_extreme_POT)
Extremes_per_year = function(df){
Extremes_DF = data.frame(matrix(ncol = 4, nrow = 0))
colna = c("Year","Extreme_low", "Extreme_high","Not_extreme")
colnames(Extremes_DF) = colna
startyear = as.integer(format(as.Date(df$Date[1], format="%d/%m/%Y"),"%Y"))
endyear = as.integer(format(as.Date(df$Date[nrow(df)], format="%d/%m/%Y"),"%Y"))
years = startyear:endyear
for (y in years){
startdate = paste(y,'-01-01', sep="")
enddate = paste(y+1,'-01-01', sep="")
year = df %>%
filter((Date < enddate)&(Date >= startdate))
table = table(year$Extreme)
Extremes_DF[nrow(Extremes_DF)+1,] = c(y, as.numeric(table["Extreme-low"]), as.numeric(table["Extreme-high"]), as.numeric(table["Not-Extreme"]))
}
Year = Extremes_DF$Year
Number_of_Extremes = Extremes_DF$Extreme_high
Low_Extremes = Extremes_DF$Extreme_low
Not_Extreme = Extremes_DF$Not_extreme
plot(Year, Number_of_Extremes, col="red", pch=16)
abline(lm(Extreme_high ~ Year, data=Extremes_DF), col="red", lwd=2, lty=2)
points(Year, Low_Extremes, col="blue", pch=16)
abline(lm(Extreme_low ~ Year, data=Extremes_DF), col="blue", lwd=2, lty=2)
legend("topleft",
legend=c("Nr. of high extremes", "Nr. of low extremes", "Regression for high extremes", "Regression for low extremes"),
col=c("red","blue","red","blue"),
pch = c(16,16,NA,NA),
lty=c(NA,NA,2,2),
lwd=2)
return(Extremes_DF)
}
## Extreme at 95th percentile using POT method---
Tair_extreme_POT = Extreme_detection(TairData$Tair_f, TairData$Date, 75, 'POT')
